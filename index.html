<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Equipment Control Panel</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Custom Titlebar -->
    <div class="titlebar">
        <div class="titlebar-drag-region">
            <div class="titlebar-title">Equipment Control Panel</div>
        </div>
        <div class="titlebar-controls">
            <button class="titlebar-button" id="language-toggle-btn" title="Toggle Language">
                <span id="language-text">EN</span>
            </button>
            <button class="titlebar-button" id="theme-toggle-btn" title="Toggle Theme">
                <svg width="16" height="16" viewBox="0 0 16 16" id="theme-icon">
                    <!-- Moon icon (for dark mode) -->
                    <path id="moon-icon" d="M8 2a6 6 0 1 0 6 6 7 7 0 0 1-6-6z" fill="currentColor"/>
                    <!-- Sun icon (for bright mode) -->
                    <g id="sun-icon" style="display: none;">
                        <circle cx="8" cy="8" r="3" fill="currentColor"/>
                        <line x1="8" y1="1" x2="8" y2="3" stroke="currentColor" stroke-width="1.5"/>
                        <line x1="8" y1="13" x2="8" y2="15" stroke="currentColor" stroke-width="1.5"/>
                        <line x1="1" y1="8" x2="3" y2="8" stroke="currentColor" stroke-width="1.5"/>
                        <line x1="13" y1="8" x2="15" y2="8" stroke="currentColor" stroke-width="1.5"/>
                        <line x1="3" y1="3" x2="4.5" y2="4.5" stroke="currentColor" stroke-width="1.5"/>
                        <line x1="11.5" y1="11.5" x2="13" y2="13" stroke="currentColor" stroke-width="1.5"/>
                        <line x1="13" y1="3" x2="11.5" y2="4.5" stroke="currentColor" stroke-width="1.5"/>
                        <line x1="4.5" y1="11.5" x2="3" y2="13" stroke="currentColor" stroke-width="1.5"/>
                    </g>
                </svg>
            </button>
            <button class="titlebar-button" id="min-btn" title="Minimize">
                <svg width="12" height="12" viewBox="0 0 12 12">
                    <rect x="0" y="5" width="12" height="2" fill="currentColor"/>
                </svg>
            </button>
            <button class="titlebar-button" id="max-btn" title="Maximize">
                <svg width="12" height="12" viewBox="0 0 12 12">
                    <rect x="1" y="1" width="10" height="10" stroke="currentColor" stroke-width="1.5" fill="none"/>
                </svg>
            </button>
            <button class="titlebar-button titlebar-close" id="close-btn" title="Close">
                <svg width="12" height="12" viewBox="0 0 12 12">
                    <line x1="1" y1="1" x2="11" y2="11" stroke="currentColor" stroke-width="1.5"/>
                    <line x1="11" y1="1" x2="1" y2="11" stroke="currentColor" stroke-width="1.5"/>
                </svg>
            </button>
        </div>
    </div>

    <div class="container">
        <!-- Connection Status Bar -->
        <div class="status-bar">
            <span class="status-label" data-i18n="connection">Connection:</span>
            <span id="status-indicator" class="status-disconnected" data-i18n="disconnected">Disconnected</span>
            <div class="auto-send-controls">
                <label>
                    <input type="checkbox" id="auto-send-toggle">
                    <span class="status-label" data-i18n="autoSend">Auto-Send</span>
                </label>
                <div class="latency-input-group">
                    <input type="number" id="send-latency" class="latency-input" value="20" min="1" max="10000" placeholder="20">
                    <span class="unit-label">ms</span>
                </div>
                <span id="auto-send-indicator" class="auto-send-indicator" data-i18n="off">OFF</span>
            </div>
            <div class="debug-controls">
                <label>
                    <input type="checkbox" id="debug-mode-toggle">
                    <span class="status-label" data-i18n="debugEcho">Debug Echo</span>
                </label>
                <span class="debug-info">RX[9]:<span id="debug-rx-value">--</span> TX[6]:<span id="debug-tx-value">--</span></span>
            </div>
        </div>

        <!-- Tab Navigation -->
        <div class="tab-navigation">
            <button class="tab-button active" data-tab="commands" data-i18n="tabCommands">Control Commands</button>
            <button class="tab-button" data-tab="monitor" data-i18n="tabMonitor">Monitor</button>
            <button id="settings-btn" class="btn-settings" title="Settings"><span data-i18n="settingsBtn">⚙️ Settings</span></button>
        </div>

        <!-- Tab Content -->

        <!-- Tab 1: Control Commands -->
        <div class="tab-content active" id="tab-commands">
        <div class="section commands-section">
            <h2 data-i18n="tabCommands">Control Commands</h2>
            <p class="current-command-display"><span data-i18n="currentCommand">Current Command:</span> <span id="current-cmd-display">0 - <span data-i18n="cmdNone">None</span></span><span id="cmd-loading-icon" class="cmd-loading-icon" style="display: none;">⏳</span></p>

            <!-- Two Column Layout -->
            <div class="commands-two-column">
                <!-- Left Column -->
                <div class="commands-column">
                    <!-- System Control -->
                    <div class="command-group">
                        <h3 data-i18n="systemControl">System Control</h3>
                        <div class="commands-grid-group">
                            <button class="btn btn-command btn-start" data-cmd="1" data-name="Start Experiment" data-i18n="startExperiment" disabled>Start Experiment</button>
                            <button class="btn btn-command btn-stop" data-cmd="2" data-name="Stop Experiment" data-i18n="stopExperiment" disabled>Stop Experiment</button>
                            <button class="btn btn-command" data-cmd="30" data-name="Clear Faults" data-i18n="clearFaults" disabled>Clear Faults</button>
                        </div>
                    </div>

                    <!-- Position Control -->
                    <div class="command-group">
                        <h3 data-i18n="positionControl">Position Control</h3>
                        <div class="commands-grid-group">
                            <button class="btn btn-command" data-cmd="13" data-name="X Position Move" data-i18n="xPositionMove" disabled>X Position Move</button>
                            <button class="btn btn-command" data-cmd="15" data-name="Y Position Move" data-i18n="yPositionMove" disabled>Y Position Move</button>
                            <button class="btn btn-command" data-cmd="17" data-name="Z Position Move" data-i18n="zPositionMove" disabled>Z Position Move</button>
                            <button class="btn btn-command" data-cmd="20" data-name="XY Position Move" data-i18n="xyPositionMove" disabled>XY Position Move</button>
                        </div>
                    </div>

                    <!-- Function Control -->
                    <div class="command-group">
                        <h3 data-i18n="functionControl">Function Control</h3>
                        <div class="commands-grid-group">
                            <button class="btn btn-command" data-cmd="21" data-name="Precision Align" data-i18n="precisionAlign" disabled>Precision Align</button>
                            <button class="btn btn-command" data-cmd="22" data-name="Tension Setting" data-i18n="tensionSetting" disabled>Tension Setting</button>
                            <button class="btn btn-command" data-cmd="24" data-name="Tension Reset" data-i18n="tensionReset" disabled>Tension Reset</button>
                        </div>
                    </div>

                    <!-- Emergency Stops -->
                    <div class="command-group">
                        <h3 data-i18n="emergencyStops">Emergency Stops</h3>
                        <div class="commands-grid-group">
                            <button class="btn btn-command" data-cmd="14" data-name="Stop X-Axis" data-i18n="stopXAxis" disabled>Stop X-Axis</button>
                            <button class="btn btn-command" data-cmd="16" data-name="Stop Y-Axis" data-i18n="stopYAxis" disabled>Stop Y-Axis</button>
                            <button class="btn btn-command" data-cmd="18" data-name="Stop Z-Axis" data-i18n="stopZAxis" disabled>Stop Z-Axis</button>
                            <button class="btn btn-command btn-emergency" data-cmd="19" data-name="STOP XYZ" data-i18n="stopXYZ" disabled>STOP XYZ</button>
                            <button class="btn btn-command btn-emergency" data-cmd="23" data-name="Emergency Stop" data-i18n="emergencyStop" disabled>Emergency Stop + Clear Pulse</button>
                        </div>
                    </div>
                </div>

                <!-- Right Column -->
                <div class="commands-column">
                    <!-- Power Control -->
                    <div class="command-group">
                        <h3 data-i18n="powerServoControl">Power & Servo Control</h3>
                        <div class="power-switches-container">
                            <div class="switch-group" id="driver-power-switch-group">
                                <label class="switch-label" data-i18n="driverPower">Driver Power</label>
                                <div class="switch-wrapper">
                                    <span class="switch-state-label" data-i18n="off">OFF</span>
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="driver-power-switch" data-cmd-on="3" data-cmd-off="4" data-name="Driver Power" disabled>
                                        <span class="slider-switch"></span>
                                    </label>
                                    <span class="switch-state-label" data-i18n="on">ON</span>
                                </div>
                            </div>
                            <div class="switch-group" id="servo-module-switch-group">
                                <label class="switch-label" data-i18n="servoModule">Servo Module</label>
                                <div class="switch-wrapper">
                                    <span class="switch-state-label" data-i18n="off">OFF</span>
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="servo-module-switch" data-cmd-on="5" data-cmd-off="6" data-name="Servo Module" disabled>
                                        <span class="slider-switch"></span>
                                    </label>
                                    <span class="switch-state-label" data-i18n="on">ON</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Axis Movement -->
                    <div class="command-group">
                        <h3 data-i18n="axisMovement">Axis Movement</h3>
                        <div class="axis-controls-container">
                            <!-- XY Joystick Control -->
                            <div class="joystick-container">
                                <h4 data-i18n="xyAxisControl">X/Y Axis Control</h4>
                                <div class="joystick-wrapper">
                                    <canvas id="joystick-canvas" width="160" height="160"></canvas>
                                    <div class="joystick-labels">
                                        <span class="label-top">Y+</span>
                                        <span class="label-right">X+</span>
                                        <span class="label-bottom">Y-</span>
                                        <span class="label-left">X-</span>
                                    </div>
                                </div>
                                <div class="joystick-status">
                                    <span id="joystick-status" data-i18n="inactive">Inactive</span>
                                </div>
                            </div>

                            <!-- Z Axis Slider Control -->
                            <div class="slider-container">
                                <h4 data-i18n="zAxisControl">Z Axis Control</h4>
                                <div class="slider-wrapper">
                                    <div class="slider-label-top">Z+</div>
                                    <input type="range" id="z-slider" class="z-slider" min="-1" max="1" value="0" step="1" orient="vertical" disabled>
                                    <div class="slider-label-bottom">Z-</div>
                                </div>
                                <div class="slider-status">
                                    <span id="slider-status" data-i18n="inactive">Inactive</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        </div>

        <!-- Tab 3: Monitor -->
        <div class="tab-content" id="tab-monitor">
        <!-- Status Monitoring Section -->
        <div class="section receive-section">
            <h2 data-i18n="statusMonitoring">Status Monitoring</h2>

            <!-- 40 Boolean Status Indicators -->
            <div class="subsection">
                <h3 data-i18n="systemStatusIndicators">System Status Indicators (40 Boolean Values)</h3>
                <div id="bool-display" class="bool-grid">
                    <!-- Will be populated by JavaScript -->
                </div>
            </div>

            <!-- 10 Integer Status Values -->
            <div class="subsection">
                <h3 data-i18n="statusValues">Status Values (10 Integers)</h3>
                <div id="int-display" class="int-display-grid">
                    <!-- Will be populated by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Log Section -->
        <div class="section log-section">
            <h2 data-i18n="logTitle">Log</h2>
            <div id="log" class="log-container"></div>
        </div>
        </div>
        <!-- End of Tab 3 -->
    </div>

    <script src="locales.js"></script>
    <script src="language-manager.js"></script>
    <script src="theme-manager.js"></script>
    <script type="module" src="renderer.js"></script>
</body>
</html>
